webpackJsonp([13],{FKb5:function(e,t){},pyxQ:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("zL8q"),o={data:function(){return{categoryList:[],selectedList:[],page:1,sumList:0,initialValue:"",newCategory:""}},computed:{},mounted:function(){this.getCategoryList()},methods:{getCategoryList:function(){var e=this;this.loading=n.Loading.service({fullscreen:!0}),this.$axios("/getCategoryList",{params:{page:this.page}}).then(function(t){e.loading.close(),e.categoryList=t.data.list.map(function(e){return e.readonly=!0,e}),e.sumList=t.data.count})},modifyCategory:function(e){var t=this;this.$axios.post("/modifyCategory",{category:e}).then(function(e){0===e.errcode?(t.$message({type:"success",message:"修改成功!"}),t.getCategoryList()):t.$message({type:"error",message:e.msg})})},Edit:function(e){this.categoryList[e].readonly=!1,this.initialValue=this.categoryList[e].categoryName},comfirm:function(e){var t=this;this.$confirm("是否修改该分类?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){var a=t.categoryList[e],n=a._id,o=a.categoryName;t.categoryList[e].readonly=!0,t.modifyCategory({_id:n,categoryName:o})}).catch(function(){t.cancle(e)})},cancle:function(e){this.categoryList[e].readonly=!0,this.categoryList[e].categoryName=this.initialValue},del:function(e){var t=this;this.$confirm("是否删除分类?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){t.$axios.post("/delCategory",{id:e}).then(function(e){0===e.errcode?(t.$message({type:"success",message:e.msg}),t.getCategoryList()):t.$message({type:"error",message:e.msg})})}).catch(function(){})},delCategoryBatch:function(){this.del(this.selectedList)},createCategory:function(){var e=this;this.newCategory=this.newCategory.trim(),this.newCategory?this.$axios.post("/createCategory",{categoryName:this.newCategory}).then(function(t){0===t.errcode?(e.$message({type:"success",message:t.msg}),e.getCategoryList()):e.$message({type:"error",message:t.msg})}):this.$message({type:"error",message:"请填写分类"})},handlePageChange:function(e){this.page=e,this.getCategoryList()},handleSelectionChange:function(e){this.selectedList=e.map(function(e){return e._id})}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("d2-container",{staticClass:"page",attrs:{type:"full"}},[a("div",{staticClass:"search-wrapper"},[a("el-input",{staticClass:"search-input",attrs:{placeholder:"请输入分类名称",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.createCategory(t)}},model:{value:e.newCategory,callback:function(t){e.newCategory=t},expression:"newCategory"}}),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.createCategory}},[e._v("新增分类")])],1),e._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.categoryList,"tooltip-effect":"dark","default-sort":{prop:"date",order:"descending"}},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{ref:"test",attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"categoryName",align:"center",label:"分类名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{staticClass:"wcategory",attrs:{readonly:t.row.readonly,placeholder:"请输入内容"},model:{value:t.row.categoryName,callback:function(a){e.$set(t.row,"categoryName",a)},expression:"scope.row.categoryName"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.row.readonly,expression:"scope.row.readonly"}],attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(a){return e.Edit(t.$index)}}},[e._v("修改")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.row.readonly,expression:"!scope.row.readonly"}],staticClass:"no-margin",attrs:{type:"primary",icon:"el-icon-check"},on:{click:function(a){return e.comfirm(t.$index)}}},[e._v("确认")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.row.readonly,expression:"!scope.row.readonly"}],staticClass:"no-margin",attrs:{type:"warning",icon:"el-icon-close"},on:{click:function(a){return e.cancle(t.$index)}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(a){return e.del(t.row._id)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-button",{staticClass:"del-batch",attrs:{type:"danger",icon:"el-icon-delete"},on:{click:e.delCategoryBatch}},[e._v("批量删除")]),e._v(" "),a("div",{staticClass:"pagination-wrapper"},[a("el-pagination",{attrs:{background:"","current-page":e.page,layout:"prev, pager, next, jumper",total:e.sumList},on:{"current-change":e.handlePageChange}})],1)],1)},staticRenderFns:[]};var i=a("VU/8")(o,r,!1,function(e){a("FKb5")},null,null);t.default=i.exports}});